<!DOCTYPE html>
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Language" content="zh-CN">
<meta name="author" content="管雷鸣">
<title>客服坐席</title>
<script src="http://res.weiunity.com/msg/msg.js--"></script>
<script src="./msg.js"></script>
<script src="kefu.js"></script>
<link rel="stylesheet" type="text/css" href="./css/style.css" media="screen">
</head>
<body>


<div id="list" style="float: left;
    max-width: 400px;"></div>

<div style="float: left;
    max-width: 400px;">
	<div id="chat">
    	
   	
    	
    </div>
</div>


<script type="text/javascript">
var host = 'http://kefu.wfyuntu.com';
var socketUrl = 'ws://119.3.209.5:8081';
//var host = 'http://localhost:8080';
//var socketUrl = 'ws://localhost:8081/';

//kefu.js 接口设置
//kefu.api.getMyUser = 'http://'+host+'/user/init.json';
kefu.api.getMyUser = host+'/inset/chat/login.json';
kefu.api.getChatOtherUser = host+'/user/getUserById.json';
kefu.api.chatLog = host+'/chatLog.json';
kefu.api.uploadImage = host+'/uploadImage.json';
kefu.extend.order.requestApi = 'http://cust.wfyuntu.com/plugin/kefu/getOrderList.json';




kefu.mode='pc';
kefu.ui.list.renderAreaId = 'list';
kefu.ui.chat.renderAreaId = 'chat';

kefu.ui.chat.html = `
<div id="pc" style="width: 40rem;">    	
	<header class="chat_header" id="head" style="    
	    height: 5rem;
	    text-align: left; display: inline-flex;">
		<!-- <div class="back" id="back" onclick="kefu.ui.list.entry();">&nbsp;</div> -->
		<div class="title" id="title" style="margin-top: 0.6rem;
	    margin-left: 1rem; display: flex;">
			<img src="https://res.weiunity.com/kefu/images/head.png" id="otherUserHead" style="    height: 3.7rem;" />
			<div style="  padding-left: 0.8rem;  color: #444444; ">
				<div id="nickname" style="    font-size: 1rem;     height: 1rem;">在线咨询</div>
				<div id="onlineState" style=" font-size: 0.7rem;   padding-top: 0.3rem;">在线</div>
			</div>
			
		</div>
	</header>
	<div id="newMessageRemind">
		<div id="newMessageRemindText"><!-- 新消息：消息内容消息内容 --></div>
		<div id="newMessageRemindClose" onclick="document.getElementById('newMessageRemind').style.display='none';">X</div>
	</div>
	
	<section id="chatcontent" onclick="kefu.ui.chat.textInputClick();">
	</section>
	  
	<footer id="chat_footer">
	    <div id="input_area">
	    	<div id="inputExtend">
	            <!-- 其他，如图片、商品、订单 -->
	
	        </div>
	        <div id="inputExtendShowArea">
	            <!-- inputExtend的显示区域，如表情的显示 -->
	        </div>
	        <div id="textInput">
	        	<div id="shuruType" onclick="kefu.chat.shuruTypeChange();"><!--输入方式--></div>
	            <!-- 键盘输入 -->
	            <div id="text" contenteditable="true" onclick="kefu.ui.chat.textInputClick();" style="    width: 100%;
    height: 7rem;"></div>
	        </div>
	        <div style="text-align: right;">
	        	<button class="send">关闭</button>
	        	<input type="submit" value="发送" class="send" id="sendButton" onclick="kefu.chat.sendButtonClick();">
	        </div>
	        
	        
	    </div>
	</footer>
</div> 
`;


/* pc chat */
kefu.extend.pc={
	initChat:function(){
		kefu.chat.shuruType = 'jianpan'
		kefu.chat.shuruTypeChange();
	}
};

//kefu.js 初始化
kefu.init();
//出现列表页
kefu.ui.list.entry();


/***** 爱送达专用 *****/
//kefu.getMyUser();	//获取我的信息
var urlOtherToken = getUrlParams('otherToken');
if(urlOtherToken == null || urlOtherToken.length < 1){
	console.log('未传入otherToken');
	//alert('未传入otherToken');
}
kefu.getMyUser = function(){
	if(kefu.api.getMyUser == null || kefu.api.getMyUser.length < 1){
		msg.popups('请设置 kefu.api.getMyUser 接口，用于获取当前用户(我)的信息');
		return;
	}
	request.post(kefu.api.getMyUser,{token:kefu.token.get(), otherToken:urlOtherToken, }, function(data){
		if(data.result == '0'){
			msg.failure(data.info);
		}else{
			kefu.user = data.user;
			kefu.user.otherUserId = data.otherUserId;
			socket.connect(socketUrl);	//建立 socket 通讯
		}
	});
}
kefu.getMyUser();
/***** 爱送达专用结束 *****/

</script>

</body>


</html>